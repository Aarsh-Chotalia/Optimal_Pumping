# MATLAB Simulations

## Overview

This project contains MATLAB code and `.mat` data files (generated) for simulations involving optimal energy pumping in an entrained neural (JR) system by frequency shuffling.

## File Structure

### MATLAB Scripts

- **Code.m**  
  Main script to run the simulations and generate.

- **odejr.m**  
  Contains the ODE definitions of Jansen-Rit model with a stimulus.

- **figx.m**  
  Script to generate Figure x (x=2,3,4a,4b,5) of the paper.



### Data Files (`.mat`)

These files contain simulation results for various values of shuffling times 'st' (=1/shuffling_frequency) with Nd=21 values of delta_f uniformly spanning from 0 to 1.

| Filename     | Description                      |
|--------------|----------------------------------|
| st0.001.mat  | Simulation result for st = 0.001 |
| st0.005.mat  | Simulation result for st = 0.005 |
| st0.01.mat   | Simulation result for st = 0.01  |
| st0.05.mat   | Simulation result for st = 0.05  |
| st0.1.mat    | Simulation result for st = 0.1   |
| st0.5.mat    | Simulation result for st = 0.5   |
| st1.mat      | Simulation result for st = 1     |
| st2.mat      | Simulation result for st = 2     |
| st5.mat      | Simulation result for st = 5     |
| st10.mat     | Simulation result for st = 10    |

Additionally `d2.mat` contains simulation result for 'st=1' but with 'Nd=101' (instead of 21) for finer resolution to be used in Figure 2.
These files can be loaded using 'load('filename.mat')' in MATLAB.

## How to Run

1. Open `Code.m` in MATLAB.
2. Ensure `odejr.m` is in the same directory.
3. Run `Code.m` --> will take \approx 50 hours to run the model (Depends on the processor) and generate the data.
4. Alternatively, use the `.mat` data provided in this repository and proceed to the next step.
5. Run `figx.m` (x=2,3,4a,4b,5) to reproduce the final plots shown in the paper.

Note that fig2.m uses the data file `d2.mat` contains simulation result for st=1 but with Nd=101 for finer resolution. This can be generated by changing Nd=21 to Nd=101 in `Code.m`. 

## Requirements

- MATLAB R2020 or newer (recommended)
- Signal Processing Toolbox
- Access to all `.mat` files either provided in this repository or genrerated after running `Code.m`.



